#Resource Group
az group create --name TODOAPP --location brazilsouth

#ACI MongoDB
az container create --resource-group todoapp --name mongodb --image mongo --ip-address public --port 27017 --location eastus
export MONGOCONNSTR="mongodb://`az container show --resource-group todoapp --name mongodb --output table | grep -w mongodb | awk '{print $5}'`"

#Container TODO App accessing mongodb...
docker run -d --env DB="$MONGOCONNSTR" -p 80:3000 --name todoapp msleal/todoapp

#CosmosDB
az cosmosdb create --resource-group todoapp --name cosmosdbnosql --kind MongoDB 
export COSMOSCONNSTR=`az cosmosdb list-connection-strings --resource-group todoapp --name cosmosdbnosql --output json | grep 'connectionString": "' | awk '{print $2}' | sed 's/,//' | sed 's/"//g'`

#Container TODO App accessing Cosmosdb...
docker run -d --env DB="$COSMOSCONNSTR" -p 80:3000 --name todoapp msleal/todoapp
